---
title: "Data_Cleansing"
output: html_notebook
---
Import Data and make into data frame
```{r}
data_math = read.table("student/student-mat.csv",sep=";",header=TRUE)
data_por = read.table("student/student-por.csv",sep=";",header=TRUE)

data_all = merge(data_math,data_por,by=c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet"))
```

Create Score variable
```{r}
#Function: get_score
#Description:
#This function takes the students grades from the 3 trimesters and generates a 
#score that will be used to create classes for the classification algorithms
#inputs:
#->data: data frame of student performance
#outputs:
#->student_score: vector of score values for student performance
get_score = function(data){
  student_score = NULL
  for(i in 1:dim(data)[1]){
    grades = as.numeric(unlist(data[i, 31:33]))
    d_avg = mean(grades[3] - grades[2], grades[2] - grades[1])
    student_score = c(student_score, (1 + (d_avg / 20))*data[i,33])
  }
  return(student_score)
}

#Generate Student Scores and add to data frames
student_score_math = get_score(data_math)
student_score_por = get_score(data_por)

data_math = cbind(data_math, Student_Score = student_score_math)
data_por = cbind(data_por, Student_Score = student_score_por)

```

Create/Assign Classes
```{r}
#Plot of histograms of both student score vectors
par(mfrow = c(2,1))
hist(student_score_math, main = "Student Scores for Math", xlab = "Student Score")
hist(student_score_por,main = "Student Scores for Portugese", xlab = "Student Score")

#Create classes
#Function: create_classes
#Description:
#This function takes the the student score values and determines the boundaries of each class
#inputs:
#->student score: vector of score values for student performance
#outputs:
#->bounds: vector containing two boundaries of the classes
create_classes = function(student_score){
  size = ceiling(length(student_score) / 3)
  
  temp = sort(student_score)
  bound1 = temp[size]
  bound2 = temp[2 * size]
  return(c(bound1, bound2))
}

#Create boundaries of classes
bounds_math = create_classes(student_score_math)
bounds_por = create_classes(student_score_por)

#Assign Classes

#Function: assign_class
#Description:
#This function uses the bounds and the score values to assign classes
#inputs:
#->student score: vector of score values for student performance
#->bounds: vector containing two boundaries of the classes
#outputs:
#->student_class: vector of class assignments
assign_class = function(student_score, bounds){
  student_class = NULL
  
  #Loop through scores
  for(i in 1:length(student_score)){
    
    #Select apropriate class based on score
    if(student_score[i] < bounds[1]){
      student_class = c(student_class, 1)
    }
    else if(student_score[i] >= bounds[2]){
      student_class = c(student_class, 3)
    }
    else{
      student_class = c(student_class, 2)
    }
  }
  
  return(student_class)
}

#Create classes and append to data frame
classes_math = assign_class(student_score_math, bounds_math)
classes_por = assign_class(student_score_por, bounds_por)

data_math = cbind(data_math, Student_Class = as.factor(classes_math))
data_por = cbind(data_por, Student_Class = as.factor(classes_por))

```
